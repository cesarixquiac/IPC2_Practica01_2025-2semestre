CREATE DATABASE IF NOT EXISTS  Reino_de_Hyrule_Practica01_IPC2 ;
USE Reino_de_Hyrule_Practica01_IPC2;

CREATE TABLE evento (
  codigo_evento VARCHAR(255) PRIMARY KEY,
  fecha_evento DATE NOT NULL,
  tipo_evento VARCHAR(20) NOT NULL, -- CHARLA, CONGRESO, TALLER, DEBATE
  titulo VARCHAR(200) NOT NULL,
  ubicacion VARCHAR(150) NOT NULL,
  cupo_maximo INT NOT NULL,
  costo_inscripcion DECIMAL(10,2) NOT NULL
);

CREATE TABLE participante (
  correo VARCHAR(100) PRIMARY KEY,
  nombre_completo VARCHAR(45) NOT NULL,
  tipo_participante VARCHAR(20) NOT NULL, -- ESTUDIANTE, PROFESIONAL, INVITADO
  institucion VARCHAR(150) NOT NULL
);

CREATE TABLE inscripcion (
  id INT AUTO_INCREMENT PRIMARY KEY,
  correo_participante VARCHAR(100),
  codigo_evento VARCHAR(255),
  tipo_inscripcion VARCHAR(20) NOT NULL,
  validada BOOLEAN NOT NULL DEFAULT FALSE,
  CONSTRAINT fk_inscripcion_participante FOREIGN KEY (correo_participante) REFERENCES participante(correo),
  CONSTRAINT fk_inscripcion_evento FOREIGN KEY (codigo_evento) REFERENCES evento(codigo_evento),
  UNIQUE KEY unique_participante_evento (correo_participante, codigo_evento)
);


CREATE TABLE pago (
  id INT AUTO_INCREMENT PRIMARY KEY,
  id_inscripcion INT,
  metodo_pago VARCHAR(20) NOT NULL, -- EFECTIVO, TRANSFERENCIA, TARJETA
  monto DECIMAL(10,2) NOT NULL,
  CONSTRAINT fk_pago_inscripcion FOREIGN KEY (id_inscripcion) REFERENCES inscripcion(id)
);

CREATE TABLE actividad (
  codigo_actividad VARCHAR(255) PRIMARY KEY,
  codigo_evento VARCHAR(255),
  tipo_actividad VARCHAR(20) NOT NULL, -- CHARLA, TALLER, DEBATE, OTRA
  titulo VARCHAR(200) NOT NULL,
  correo_encargado VARCHAR(100),
  hora_inicio TIME NOT NULL,
  hora_fin TIME NOT NULL,
  cupo_maximo INT NOT NULL,
  CONSTRAINT fk_actividad_evento FOREIGN KEY (codigo_evento) REFERENCES evento(codigo_evento),
  CONSTRAINT fk_actividad_encargado FOREIGN KEY (correo_encargado) REFERENCES participante(correo)
);

CREATE TABLE asistencia (
  id INT AUTO_INCREMENT PRIMARY KEY,
  correo_participante VARCHAR(100),
  codigo_actividad VARCHAR(255),
  CONSTRAINT fk_asistencia_participante FOREIGN KEY (correo_participante) REFERENCES participante(correo),
  CONSTRAINT fk_asistencia_actividad FOREIGN KEY (codigo_actividad) REFERENCES actividad(codigo_actividad)
);

CREATE TABLE certificado (
  id INT AUTO_INCREMENT PRIMARY KEY,
  correo_participante VARCHAR(100),
  codigo_evento VARCHAR(255),
  fecha_emision DATE NOT NULL,
  CONSTRAINT fk_certificado_participante FOREIGN KEY (correo_participante) REFERENCES participante(correo),
  CONSTRAINT fk_certificado_evento FOREIGN KEY (codigo_evento) REFERENCES evento(codigo_evento)
);
